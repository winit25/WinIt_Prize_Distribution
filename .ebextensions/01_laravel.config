option_settings:
  aws:elasticbeanstalk:application:environment:
    COMPOSER_HOME: /root
    
commands:
  00_disable_default_composer:
    command: "echo 'Skipping default composer install - handled by platform'"
    
container_commands:
  01_create_directories:
    command: |
      mkdir -p storage/framework/{sessions,views,cache} storage/logs bootstrap/cache
      chmod -R 775 storage bootstrap/cache
      chown -R webapp:webapp storage bootstrap/cache || true
  02_permissions:
    command: |
      chmod -R 775 storage bootstrap/cache
      chown -R webapp:webapp storage bootstrap/cache || true
  03_config_cache:
    command: "php artisan config:cache || true"
    leader_only: true
